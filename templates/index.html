<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Translator</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        let eventSource;

        function startProgress() {
            if (!eventSource) {
                eventSource = new EventSource("/progress");
                eventSource.onmessage = function (event) {
                    const progressText = event.data;
                    if (progressText === "complete") {
                        document.getElementById("progress-bar").value = 100;
                        document.getElementById("status").innerText = "‚úÖ Translation Complete!";
                        document.getElementById("pause-btn").disabled = true;
                        document.getElementById("resume-btn").disabled = true;
                        eventSource.close();
                        eventSource = null;
                    } else {
                        const [current, total] = progressText.split("/");
                        const percentage = (current / total) * 100;
                        document.getElementById("progress-bar").value = percentage;
                        document.getElementById("status").innerText = `Progress: ${current}/${total}`;
                    }
                };
            }
        }

        function pauseTranslation() {
            fetch("/pause", { method: "POST" });
            document.getElementById("status").innerText = "‚è∏ Translation Paused!";
        }

        function resumeTranslation() {
            fetch("/resume", { method: "POST" });
            document.getElementById("status").innerText = "‚ñ∂Ô∏è Translation Resumed!";
        }
    </script>
</head>
<body onload="startProgress()">
    <div class="container">
        <h1>üåü File Translator üåü</h1>
        <form action="/upload" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="source_language">Source Language:</label>
                <select name="source_language" required>
                    {% for language in languages %}
                    <option value="{{ language }}">{{ language }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="target_language">Target Language:</label>
                <select name="target_language" required>
                    {% for language in languages %}
                    <option value="{{ language }}">{{ language }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="files">Upload Files:</label>
                <input type="file" name="files" multiple required>
            </div>
            <button type="submit" class="btn">Start Translation</button>
        </form>

        <div class="progress-container">
            <progress id="progress-bar" value="0" max="100"></progress>
            <p id="status">Progress: 0/0</p>
            <button id="pause-btn" class="btn" onclick="pauseTranslation()">Pause</button>
            <button id="resume-btn" class="btn" onclick="resumeTranslation()">Resume</button>
        </div>

        <div class="download-container">
            <a href="/download_zip" class="btn">Download Translations (ZIP)</a>
        </div>
    </div>
</body>
</html>
